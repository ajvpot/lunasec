session_name: lunatrace
windows:
  - window_name: services
    layout: tiled
    panes:
      - shell_command:
          - cd ory/oathkeeper
          - oathkeeper --config config.yaml serve
      - shell_command:
          - cd hasura
          - >-
            /home/breadchris/projects/lunasec-monorepo/tools/service-scripts/wait-for-it.sh
            -h localhost -p 8080 && sleep 3
          - hasura console
      - shell_command:
          - cd frontend
          - yarn run start:server
      - shell_command:
          - sudo docker-compose down && sudo docker-compose up
  - window_name: backend
    layout: tiled
    panes:
      - shell_command:
          - >-
            smee -u https://smee.io/PFQhzcyUpi770GiD -p 3002 -P
            /github/webhook/events
      - shell_command:
          - cd backend
          - >-
            GITHUB_APP_ID="179126" GITHUB_APP_PRIVATE_KEY="$(cat
            github-app-dev.2022-03-09.private-key.pem | base64 -w0)" yarn run
            start:server
  - window_name: etl
    layout: tiled
    panes:
      - shell_command:
          - cd backend
          - >-
            GITHUB_APP_ID="179126" GITHUB_APP_PRIVATE_KEY="$(cat
            github-app-dev.2022-03-09.private-key.pem | base64 -w0)"
            QUEUE_NAME="lunatrace-EtlStorage-ProcessManifestProcessingQueue7A1F1CB2-wVcNqaEtNUJP"
            QUEUE_HANDLER="process-manifest-queue" yarn run start:etl
      - shell_command:
          - cd backend
          - >-
            GITHUB_APP_ID="179126" GITHUB_APP_PRIVATE_KEY="$(cat
            github-app-dev.2022-03-09.private-key.pem | base64 -w0)"
            QUEUE_NAME="lunatrace-EtlStorage-ProcessSbomProcessingQueueA3A9FE69-o0GF3tUpwNnn"
            QUEUE_HANDLER="process-sbom-queue" yarn run start:etl
