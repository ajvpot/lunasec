/*
 * Copyright by LunaSec (owned by Refinery Labs, Inc)
 *
 * Licensed under the Business Source License v1.1
 * (the "License"); you may not use this file except in compliance with the
 * License. You may obtain a copy of the License at
 *
 * https://github.com/lunasec-io/lunasec/blob/master/licenses/BSL-LunaTrace.txt
 *
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
export class Graph {
  private childEdges: Map<string, string> = new Map();
  private parentEdges: Map<string, Set<string>> = new Map();
  private childToEdgeIds: Map<string, Set<string>> = new Map();

  public insertEdge(edgeId: string, parentId: string, childId: string) {
    this.childEdges.set(parentId, childId);

    const existingParentEdges = this.parentEdges.get(childId);
    if (!existingParentEdges) {
      this.parentEdges.set(childId, new Set([parentId]));
    } else {
      existingParentEdges.add(parentId);
    }

    const existingEdgesToChild = this.childToEdgeIds.get(childId);
    if (!existingEdgesToChild) {
      this.childToEdgeIds.set(childId, new Set([edgeId]));
    } else {
      existingEdgesToChild.add(edgeId);
    }
  }

  public getParentEdges(childId: string) {
    return this.parentEdges.get(childId) || new Set();
  }

  public getNodeEdgeIds(childId: string) {
    return this.childToEdgeIds.get(childId) || new Set();
  }
}
