export class Graph {
  private forwardEdges: Map<string, string> = new Map();
  private backwardEdges: Map<string, Set<string>> = new Map();
  private childToEdgeIds: Map<string, Set<string>> = new Map();

  public insertEdge(id: string, parent: string, child: string) {
    this.forwardEdges.set(parent, child);

    const existingParentEdges = this.backwardEdges.get(child);
    if (!existingParentEdges) {
      this.backwardEdges.set(child, new Set([parent]));
    } else {
      existingParentEdges.add(parent);
    }

    const existingEdgesToChild = this.childToEdgeIds.get(child);
    if (!existingEdgesToChild) {
      this.childToEdgeIds.set(child, new Set([id]));
    } else {
      existingEdgesToChild.add(id);
    }
  }

  public inboundNeighbors(child: string) {
    return this.backwardEdges.get(child) || new Set();
  }

  public inboundEdges(child: string) {
    return this.childToEdgeIds.get(child) || new Set();
  }
}
