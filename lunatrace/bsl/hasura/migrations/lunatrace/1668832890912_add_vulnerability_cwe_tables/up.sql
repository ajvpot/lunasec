alter table "public"."build_log" drop constraint "build_log_build_id_fkey",
  add constraint "build_log_build_id_fkey"
  foreign key ("build_id")
  references "public"."builds"
  ("id") on update cascade on delete cascade;

CREATE TABLE "vulnerability"."vulnerability_cwe" (
    "id" uuid NOT NULL DEFAULT gen_random_uuid(),
    "vulnerability_id" uuid NOT NULL,
    "cwe_id" integer NOT NULL,
    PRIMARY KEY ("id"),
    FOREIGN KEY ("vulnerability_id") REFERENCES "vulnerability"."vulnerability"("id") ON UPDATE cascade ON DELETE cascade,
    UNIQUE ("vulnerability_id", "cwe_id")
);

COMMENT ON TABLE "vulnerability"."vulnerability_cwe" IS E'CWEs that are defined for a vulnerability';

CREATE TABLE "vulnerability"."cwe" (
    "id" integer NOT NULL,
    "name" text NOT NULL,
    "description" text NOT NULL,
    "extended_description" text NOT NULL,
    "common_name" text NULL,
    PRIMARY KEY ("id")
);

COMMENT ON TABLE "vulnerability"."cwe" IS E'Common Weakness Enumeration\'s as defined by Mitre (https://cwe.mitre.org/data/definitions/699.html)';

alter table "vulnerability"."vulnerability_cwe"
  add constraint "vulnerability_cwe_cwe_id_fkey"
  foreign key ("cwe_id")
  references "vulnerability"."cwe"
  ("id") on update cascade on delete cascade;
