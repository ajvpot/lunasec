

alter table "public"."findings" add column "vulnerability_v2_id" uuid
 null;

alter table "public"."findings" alter column "vulnerability_id" drop not null;

alter table "public"."findings"
  add constraint "findings_vulnerability_v2_id_fkey"
  foreign key ("vulnerability_v2_id")
  references "vulnerability"."vulnerability"
  ("id") on update set null on delete set null;

alter table "public"."ignored_vulnerabilities" add column "vulnerability_v2_id" uuid
 null;

alter table "public"."ignored_vulnerabilities" alter column "vulnerability_id" drop not null;

alter table "public"."ignored_vulnerabilities"
  add constraint "ignored_vulnerabilities_vulnerability_v2_id_fkey"
  foreign key ("vulnerability_v2_id")
  references "vulnerability"."vulnerability"
  ("id") on update cascade on delete cascade;

alter table "public"."ignored_vulnerabilities" alter column "vulnerability_v2_id" set not null;

alter table "public"."findings" drop column "vulnerability_v2_id" cascade;

alter table "public"."findings" drop constraint "findings_vulnerability_id_fkey",
  add constraint "findings_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "vulnerability"."vulnerability"
  ("id") on update no action on delete no action;

alter table "public"."findings" drop constraint "findings_vulnerability_id_fkey",
  add constraint "findings_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "vulnerability"."vulnerability"
  ("id") on update no action on delete no action;

alter table "public"."ignored_vulnerabilities" drop column "vulnerability_v2_id" cascade;

alter table "public"."ignored_vulnerabilities" drop constraint "ignored_vulnerabilities_vulnerability_id_fkey",
  add constraint "ignored_vulnerabilities_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "vulnerability"."vulnerability"
  ("id") on update no action on delete cascade;

alter table "public"."findings" alter column "vulnerability_id" set not null;

alter table "public"."guide_vulnerabilities" drop constraint "guide_vulnerabilities_vulnerability_id_fkey",
  add constraint "guide_vulnerabilities_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "vulnerability"."vulnerability"
  ("id") on update no action on delete cascade;

alter table "vulnerability"."equivalent" alter column "a" set not null;

alter table "vulnerability"."equivalent" alter column "b" set not null;
