
alter table "vulnerability"."vulnerability" alter column "severity" drop not null;
alter table "vulnerability"."vulnerability" add column "severity" text;

-- Could not auto-generate a down migration.
-- Please write an appropriate down migration for the SQL below:
-- alter table "vulnerability"."vulnerability" add column "cvss_score" real
--  null;

-- Could not auto-generate a down migration.
-- Please write an appropriate down migration for the SQL below:
-- alter table "vulnerability"."vulnerability" add column "severity" text
--  null;

-- Could not auto-generate a down migration.
-- Please write an appropriate down migration for the SQL below:
-- alter table "vulnerability"."affected" add column "version_constraint" text
--  null;


alter table "vulnerability"."equivalent" alter column "b" drop not null;

alter table "vulnerability"."equivalent" alter column "a" drop not null;

alter table "public"."guide_vulnerabilities" drop constraint "guide_vulnerabilities_vulnerability_id_fkey",
  add constraint "guide_vulnerabilities_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "public"."vulnerabilities"
  ("id") on update no action on delete cascade;

alter table "public"."findings" alter column "vulnerability_id" drop not null;

alter table "public"."ignored_vulnerabilities" drop constraint "ignored_vulnerabilities_vulnerability_id_fkey",
  add constraint "ignored_vulnerabilities_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "public"."vulnerabilities"
  ("id") on update no action on delete cascade;

alter table "public"."ignored_vulnerabilities"
  add constraint "ignored_vulnerabilities_vulnerability_v2_id_fkey"
  foreign key (vulnerability_v2_id)
  references "vulnerability"."vulnerability"
  (id) on update cascade on delete cascade;
alter table "public"."ignored_vulnerabilities" alter column "vulnerability_v2_id" drop not null;
alter table "public"."ignored_vulnerabilities" add column "vulnerability_v2_id" uuid;

alter table "public"."findings" drop constraint "findings_vulnerability_id_fkey",
  add constraint "findings_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "vulnerability"."vulnerability"
  ("id") on update no action on delete no action;

alter table "public"."findings" drop constraint "findings_vulnerability_id_fkey",
  add constraint "findings_vulnerability_id_fkey"
  foreign key ("vulnerability_id")
  references "public"."vulnerabilities"
  ("id") on update no action on delete no action;

alter table "public"."findings"
  add constraint "findings_vulnerability_v2_id_fkey"
  foreign key (vulnerability_v2_id)
  references "vulnerability"."vulnerability"
  (id) on update set null on delete set null;
alter table "public"."findings" alter column "vulnerability_v2_id" drop not null;
alter table "public"."findings" add column "vulnerability_v2_id" uuid;

alter table "public"."ignored_vulnerabilities" alter column "vulnerability_v2_id" drop not null;


alter table "public"."ignored_vulnerabilities" drop constraint "ignored_vulnerabilities_vulnerability_v2_id_fkey";

alter table "public"."ignored_vulnerabilities" alter column "vulnerability_id" set not null;

-- Could not auto-generate a down migration.
-- Please write an appropriate down migration for the SQL below:
-- alter table "public"."ignored_vulnerabilities" add column "vulnerability_v2_id" uuid
--  null;

alter table "public"."findings" drop constraint "findings_vulnerability_v2_id_fkey";

alter table "public"."findings" alter column "vulnerability_id" set not null;

-- Could not auto-generate a down migration.
-- Please write an appropriate down migration for the SQL below:
-- alter table "public"."findings" add column "vulnerability_v2_id" uuid
--  null;
