query GetVulnerability($package_name: String!, $package_manager: package_manager!) {
    vulnerability(where: {affected: {package: {name: {_eq: $package_name}, package_manager: {_eq: $package_manager}}}, withdrawn: {_is_null: true}}) {
        id
        affected {
            affected_range_events {
                type
                event
                version
            }
            affected_versions {
                version
            }
            package {
                name
                package_manager
            }
        }
        equivalents {
            vulnerability {
                id
                source
                source_id
            }
        }
        references {
            id
            url
        }
        source
        source_id
    }
}

query GetVulnerabilityMetadata($id: uuid!) {
    vulnerability_by_pk(id: $id) {
        id
        source
        source_id
        references {
            url
        }
        details
        affected {
            package {
                id
                name
                package_manager
            }
        }
    }
}
